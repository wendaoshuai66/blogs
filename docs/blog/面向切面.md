# é¢å‘åˆ‡é¢åˆæ¢

## ä»€ä¹ˆæ˜¯ AOP å‘¢ï¼Ÿä¸‹é¢æ˜¯æ¥è‡ªç™¾ç§‘çš„ä¸€æ®µè¯

Aspect Oriented Programming(AOP)ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒçƒ­é—¨çš„è¯é¢˜ã€‚AOP ä¸»è¦å®ç°çš„ç›®çš„æ˜¯é’ˆå¯¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­çš„åˆ‡é¢è¿›è¡Œæå–ï¼Œå®ƒæ‰€é¢å¯¹çš„æ˜¯å¤„ç†è¿‡ç¨‹ä¸­çš„æŸä¸ªæ­¥éª¤æˆ–é˜¶æ®µï¼Œä»¥è·å¾—é€»è¾‘è¿‡ç¨‹ä¸­å„éƒ¨åˆ†ä¹‹é—´ä½è€¦åˆæ€§çš„éš”ç¦»æ•ˆæœã€‚æ¯”å¦‚æˆ‘ä»¬æœ€å¸¸è§çš„å°±æ˜¯æ—¥å¿—è®°å½•äº†ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç°åœ¨æä¾›ä¸€ä¸ªæŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯çš„æœåŠ¡ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›è®°å½•æœ‰è°è¿›è¡Œäº†è¿™ä¸ªæŸ¥è¯¢ã€‚å¦‚æœæŒ‰ç…§ä¼ ç»Ÿçš„ OOP çš„å®ç°çš„è¯ï¼Œé‚£æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªæŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯çš„æœåŠ¡æ¥å£(StudentInfoService)å’Œå…¶å®ç° ç±» ï¼ˆStudentInfoServiceImpl.javaï¼‰ï¼ŒåŒæ—¶ä¸ºäº†è¦è¿›è¡Œè®°å½•çš„è¯ï¼Œé‚£æˆ‘ä»¬åœ¨å®ç°ç±»(StudentInfoServiceImpl.java)ä¸­è¦æ·»åŠ å…¶å®ç°è®°å½•çš„è¿‡ç¨‹ã€‚è¿™æ ·çš„è¯ï¼Œå‡å¦‚æˆ‘ä»¬è¦å®ç°çš„æœåŠ¡æœ‰å¤šä¸ªå‘¢ï¼Ÿé‚£å°±è¦åœ¨æ¯ä¸ªå®ç°çš„ç±»éƒ½æ·»åŠ è¿™äº›è®°å½•è¿‡ç¨‹ã€‚è¿™æ ·åšçš„è¯å°±ä¼šæœ‰ç‚¹ç¹çï¼Œè€Œä¸”æ¯ä¸ªå®ç°ç±»éƒ½ä¸è®°å½•æœåŠ¡æ—¥å¿—çš„è¡Œä¸ºç´§è€¦åˆï¼Œè¿åäº†é¢å‘å¯¹è±¡çš„è§„åˆ™ã€‚é‚£ä¹ˆæ€æ ·æ‰èƒ½æŠŠè®°å½•æœåŠ¡çš„è¡Œä¸ºä¸ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­åˆ†ç¦»å‡ºæ¥å‘¢ï¼Ÿçœ‹èµ·æ¥å¥½åƒå°±æ˜¯æŸ¥è¯¢å­¦ç”Ÿçš„æœåŠ¡è‡ªå·±åœ¨è¿›è¡Œï¼Œä½†å´æ˜¯èƒŒåæ—¥å¿—è®°å½•å¯¹è¿™äº›è¡Œä¸ºè¿›è¡Œè®°å½•ï¼Œå¹¶ä¸”æŸ¥è¯¢å­¦ç”Ÿçš„æœåŠ¡ä¸çŸ¥é“å­˜åœ¨è¿™äº›è®°å½•è¿‡ç¨‹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦è®¨è®º AOP çš„ç›®çš„æ‰€åœ¨ã€‚AOP çš„ç¼–ç¨‹ï¼Œå¥½åƒå°±æ˜¯æŠŠæˆ‘ä»¬åœ¨æŸä¸ªæ–¹é¢çš„åŠŸèƒ½æå‡ºæ¥ä¸ä¸€æ‰¹å¯¹è±¡è¿›è¡Œéš”ç¦»ï¼Œè¿™æ ·ä¸ä¸€æ‰¹å¯¹è±¡ä¹‹é—´é™ä½äº†è€¦åˆæ€§ï¼Œå¯ä»¥å°±æŸä¸ªåŠŸèƒ½è¿›è¡Œç¼–ç¨‹ã€‚

##### ç»¼ä¸Šæ‰€è¿°ï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹å°±æ˜¯é€šè¿‡é¢„ç¼–è¯‘å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç»™ç¨‹åºåŠ¨æ€ç»Ÿä¸€æ·»åŠ åŠŸèƒ½çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒæ‰€é¢å¯¹çš„æ˜¯å¤„ç†è¿‡ç¨‹ä¸­æŸä¸ªæ­¥éª¤æˆ–é˜¶æ®µï¼Œä»¥è·å¾—é€»è¾‘è¿‡ç¨‹ä¸­å„éƒ¨åˆ†ä¹‹é—´ä½è€¦åˆæ€§çš„éš”ç¦»æ•ˆæœ

è”æƒ³ä¸€ä¸‹åˆ‡é¢åŒ…ã€åœ°æ¿æµ‹é‡

## ä¸¾ä¸ªä¾‹å­

æ¯”å¦‚è€å¤§ç»™ä½ æ´¾äº†ä»»åŠ¡ï¼šç»Ÿè®¡ä¸€ä¸‹å½“å‰æ‰€æœ‰å‡½æ•°è°è€—æ—¶æœ€é•¿

ä¸€èˆ¬æ€è·¯

```plain
function test() {
    var stat;
    alert(2)
    var end;
    console.log(end - start)
}
```

ç»è¿‡åˆ†æè¿™æ ·å¾ˆéš¾å—ï¼Œ1 æ˜¯å˜é‡å†²çªï¼›2 æ˜¯è¿˜çš„æ¯ä¸ªå‡½æ•°è¿™æ ·é‡å¤ï¼›å¾ˆè“ç˜¦ ğŸ˜£

äºæ˜¯å¯ä»¥è¿™æ ·å†™ï¼š

```plain
function test() {
    alert(2)
}
Function.prototype.before = function(fn) {
    //æŠŠthisä¿å­˜ï¼›ä»¥ä¾¿åé¢å‡ºç°é—®é¢˜å¥½æ‹¿åˆ°thisçš„ç¼“å­˜
    var __self = this;
    fn()
    __self.apply(this, arguments)
}
Function.prototype.after = function(fn) {
    //æŠŠthisä¿å­˜ï¼›ä»¥ä¾¿åé¢å‡ºç°é—®é¢˜å¥½æ‹¿åˆ°thisçš„ç¼“å­˜
    var __self = this;
    //afterå…ˆæ‰§è¡Œæœ¬èº«thisï¼Œå†æ‰§è¡Œå›è°ƒ
    __self.apply(this, arguments)
    fn()
}
test.before(function() {
    alert(1)
})
test.after(function() {
    alert(3)
}) alert(3)
})
```

ä½†æ˜¯é»˜è®¤å‡½æ•°ä¼šæ‰§è¡Œäº†ä¸¤éï¼Œtest ä½œä¸ºä¸­è½¬

before å›è°ƒå’Œ before ä¸€èµ·é€åˆ° after å»

after after å’Œ test ä¸€èµ·é€åˆ° before(after å¯ä»¥å†™åˆ°å‰é¢)

```plain
function test() {
    alert(2)
}
Function.prototype.before = function(fn) {
    //æŠŠthisä¿å­˜ï¼›ä»¥ä¾¿åé¢å‡ºç°é—®é¢˜å¥½æ‹¿åˆ°thisçš„ç¼“å­˜
    var __self = this;
    return function() {
        //ç”±äºthisæ”¹å˜ï¼Œä¸ºä»¥åæ–¹ä¾¿æ‹“å±•æ‰€ä»¥fn
        fn.apply(this, arguments)
        __self.apply(this, arguments)
    }
}
Function.prototype.after = function(fn) {
    //æŠŠthisä¿å­˜ï¼›ä»¥ä¾¿åé¢å‡ºç°é—®é¢˜å¥½æ‹¿åˆ°thisçš„ç¼“å­˜
    var __self = this;
    //afterå…ˆæ‰§è¡Œæœ¬èº«thisï¼Œå†æ‰§è¡Œå›è°ƒ
    __self.apply(this, arguments)
    fn.apply(this, arguments)
}
test.before(function() {
    alert(1)
}).after(function() {
    alert(3)
})
```

è¿™æ ·å°±å¯ä»¥äº†ï¼Œæ•´ä¸ªé¡ºåºæ˜¯ æŒ‚è½½ selfï¼ˆtestï¼‰æ‰§è¡Œ before å›è°ƒ æ‰§è¡Œ self after è‡ªå·±æ‰§è¡Œå›è°ƒ

æˆ‘ä»¬å¯ä»¥å†åŠ ä¸€äº›éªŒè¯

```plain
//ç»Ÿè®¡ä¸€ä¸‹å½“å‰æ‰€æœ‰å‡½æ•°è°è€—æ—¶æœ€é•¿

function test() {
    alert(2)
    return "me"
}
Function.prototype.before = function(fn) {
    //æŠŠthisä¿å­˜ï¼›ä»¥ä¾¿åé¢å‡ºç°é—®é¢˜å¥½æ‹¿åˆ°thisçš„ç¼“å­˜
    var __self = this;
    return function() {
        //ç”±äºthisæ”¹å˜ï¼Œä¸ºä»¥åæ–¹ä¾¿æ‹“å±•æ‰€ä»¥fn
        if (fn.apply(this, arguments) == false) {
            return false
        }
        return __self.apply(this, arguments)
    }
}
Function.prototype.after = function(fn) {
    //æŠŠthisä¿å­˜ï¼›ä»¥ä¾¿åé¢å‡ºç°é—®é¢˜å¥½æ‹¿åˆ°thisçš„ç¼“å­˜
    var __self = this;
    //afterå…ˆæ‰§è¡Œæœ¬èº«thisï¼Œå†æ‰§è¡Œå›è°ƒ
    var result = __self.apply(this, arguments)
        //ä¸Šä¸€ä¸ªå‡½æ•°ä¼ è¿‡æ¥çš„å€¼
    if (result == false) {
        return false
    }
    fn.apply(this, arguments)
    return result;
}
test.before(function() {
    alert(1)
}).after(function() {
    alert(3)
})
```

## å…¶ä»–æ¡ˆä¾‹

åœ¨è¿›è¡ŒåŸ‹ç‚¹æ—¶ä¹Ÿä¼šç”¨åˆ°ï¼Œå¯ä»¥è§‚çœ‹ä¸€äº›[ä¾‹å­](https://segmentfault.com/a/1190000014922668)
